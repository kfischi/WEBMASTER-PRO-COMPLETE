<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebMaster Pro - אדיטור ויזואלי AI מהפכני | רמה 10</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&family=JetBrains+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --accent: #f093fb;
            --success: #26de81;
            --warning: #fed330;
            --danger: #f5576c;
            --dark: #0a0a0a;
            --dark-light: #1a1a2e;
            --dark-lighter: #2d2d4a;
            --light: #ffffff;
            --gray: #8b8b8b;
            --gray-light: #f5f5f5;
            
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-ai: linear-gradient(135deg, #ff6b6b 0%, #feca57 25%, #48dbfb 50%, #ff9ff3 75%, #54a0ff 100%);
            --gradient-dark: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #2d2d4a 100%);
            --gradient-glass: rgba(255, 255, 255, 0.1);
            
            --shadow-light: 0 4px 20px rgba(0, 0, 0, 0.1);
            --shadow-medium: 0 8px 40px rgba(0, 0, 0, 0.15);
            --shadow-heavy: 0 20px 80px rgba(0, 0, 0, 0.25);
            --shadow-ai: 0 0 50px rgba(255, 107, 107, 0.3);
            
            --border-radius: 16px;
            --border-radius-small: 8px;
            --border-radius-large: 24px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--gradient-dark);
            color: var(--light);
            overflow: hidden;
            height: 100vh;
            position: relative;
        }

        /* Animated Background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(102, 126, 234, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(240, 147, 251, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, rgba(38, 222, 129, 0.2) 0%, transparent 50%);
            animation: gradientShift 20s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes gradientShift {
            0%, 100% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
        }

        /* Main Layout */
        .editor-container {
            display: flex;
            height: 100vh;
            position: relative;
        }

        /* Left Toolbar */
        .left-toolbar {
            width: 80px;
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
            z-index: 1000;
        }

        .toolbar-logo {
            width: 50px;
            height: 50px;
            background: var(--gradient-ai);
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            animation: logoGlow 3s ease-in-out infinite;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toolbar-logo:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-ai);
        }

        @keyframes logoGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 107, 107, 0.5); }
            50% { box-shadow: 0 0 40px rgba(255, 107, 107, 0.8); }
        }

        .toolbar-section {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 30px;
        }

        .toolbar-button {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius-small);
            color: var(--light);
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .toolbar-button:hover {
            background: var(--gradient-primary);
            transform: scale(1.05);
            box-shadow: var(--shadow-medium);
        }

        .toolbar-button.active {
            background: var(--gradient-primary);
            box-shadow: var(--shadow-medium);
        }

        .toolbar-button.ai {
            background: var(--gradient-ai);
            animation: aiPulse 2s ease-in-out infinite;
        }

        @keyframes aiPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Left Sidebar */
        .left-sidebar {
            width: 350px;
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            transform: translateX(-350px);
            transition: transform 0.3s ease;
            z-index: 999;
        }

        .left-sidebar.active {
            transform: translateX(0);
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .sidebar-title {
            font-size: 20px;
            font-weight: 700;
            background: var(--gradient-ai);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            background-size: 200% 200%;
            animation: gradientMove 3s ease-in-out infinite;
        }

        @keyframes gradientMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .close-sidebar {
            width: 30px;
            height: 30px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            color: var(--light);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-sidebar:hover {
            background: var(--danger);
            transform: scale(1.1);
        }

        .sidebar-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .control-section {
            margin-bottom: 30px;
        }

        .control-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--light);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
        }

        .control-item {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius-small);
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .control-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        .control-item.active {
            background: var(--gradient-primary);
            box-shadow: var(--shadow-medium);
        }

        .ai-section {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1) 0%, rgba(254, 202, 87, 0.1) 100%);
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 20px;
        }

        .ai-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .ai-button {
            width: 100%;
            background: var(--gradient-ai);
            border: none;
            border-radius: var(--border-radius-small);
            color: var(--light);
            padding: 12px 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 10px;
        }

        .ai-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-ai);
        }

        /* Center Canvas */
        .center-canvas {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .canvas-header {
            height: 60px;
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
        }

        .page-tabs {
            display: flex;
            gap: 10px;
        }

        .page-tab {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius-small);
            padding: 8px 16px;
            color: var(--light);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .page-tab.active {
            background: var(--gradient-primary);
            box-shadow: var(--shadow-light);
        }

        .add-page-btn {
            background: var(--gradient-ai);
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            color: var(--light);
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-page-btn:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-ai);
        }

        .canvas-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .device-preview {
            display: flex;
            gap: 5px;
        }

        .device-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius-small);
            padding: 8px 12px;
            color: var(--light);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .device-btn.active {
            background: var(--gradient-primary);
        }

        .canvas-viewport {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow: auto;
        }

        .website-preview {
            width: 100%;
            max-width: 1200px;
            height: 100%;
            background: var(--light);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-heavy);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .website-preview.tablet {
            max-width: 768px;
        }

        .website-preview.mobile {
            max-width: 375px;
        }

        .preview-frame {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: var(--border-radius);
        }

        /* Right Properties Panel */
        .right-panel {
            width: 320px;
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(20px);
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            transform: translateX(320px);
            transition: transform 0.3s ease;
            z-index: 999;
        }

        .right-panel.active {
            transform: translateX(0);
        }

        .panel-tabs {
            display: flex;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .panel-tab {
            flex: 1;
            padding: 15px 10px;
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }

        .panel-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: rgba(102, 126, 234, 0.1);
        }

        .panel-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .property-group {
            margin-bottom: 25px;
        }

        .property-label {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--light);
        }

        .property-control {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius-small);
            padding: 10px;
            color: var(--light);
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .property-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.3);
        }

        /* Media Library */
        .media-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
        }

        .media-item {
            aspect-ratio: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius-small);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: rgba(255, 255, 255, 0.7);
        }

        .media-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .media-item.upload {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            background: transparent;
        }

        .media-item.upload:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        /* AI Chat Interface */
        .ai-chat {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            height: 450px;
            background: rgba(26, 26, 46, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius);
            display: none;
            flex-direction: column;
            z-index: 10000;
            box-shadow: var(--shadow-heavy);
        }

        .ai-chat.active {
            display: flex;
        }

        .ai-chat-header {
            padding: 15px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .ai-chat-title {
            font-weight: 600;
            background: var(--gradient-ai);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .ai-chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
        }

        .ai-message {
            margin-bottom: 15px;
            padding: 10px 15px;
            border-radius: var(--border-radius-small);
            font-size: 14px;
            line-height: 1.5;
        }

        .ai-message.user {
            background: var(--gradient-primary);
            color: var(--light);
            margin-right: 30px;
        }

        .ai-message.ai {
            background: rgba(255, 255, 255, 0.1);
            color: var(--light);
            margin-left: 30px;
        }

        .ai-chat-input {
            padding: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .ai-input-group {
            display: flex;
            gap: 10px;
        }

        .ai-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius-small);
            padding: 10px;
            color: var(--light);
            font-size: 14px;
        }

        .ai-send-btn {
            background: var(--gradient-ai);
            border: none;
            border-radius: var(--border-radius-small);
            width: 40px;
            height: 40px;
            color: var(--light);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ai-send-btn:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-ai);
        }

        /* Floating Action Menu */
        .floating-menu {
            position: fixed;
            bottom: 80px;
            right: 30px;
            z-index: 1001;
        }

        .floating-btn {
            width: 60px;
            height: 60px;
            background: var(--gradient-ai);
            border: none;
            border-radius: 50%;
            color: var(--light);
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-medium);
            margin-bottom: 15px;
            animation: float 3s ease-in-out infinite;
        }

        .floating-btn:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-ai);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(26, 26, 46, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius);
            padding: 15px 20px;
            color: var(--light);
            font-weight: 500;
            z-index: 10001;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            box-shadow: var(--shadow-medium);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-left: 4px solid var(--success);
        }

        .notification.error {
            border-left: 4px solid var(--danger);
        }

        .notification.warning {
            border-left: 4px solid var(--warning);
        }

        /* Loading States */
        .loading-spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .left-sidebar {
                width: 300px;
                transform: translateX(-300px);
            }
            
            .right-panel {
                width: 280px;
                transform: translateX(280px);
            }
        }

        @media (max-width: 768px) {
            .left-toolbar {
                width: 60px;
            }
            
            .toolbar-button {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            .ai-chat {
                width: 300px;
                right: 10px;
                bottom: 10px;
            }
        }

        /* Welcome Screen */
        .welcome-screen {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            transition: opacity 0.5s ease;
        }

        .welcome-content {
            text-align: center;
            max-width: 600px;
            padding: 40px;
        }

        .welcome-title {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 20px;
            background: var(--gradient-ai);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            background-size: 200% 200%;
            animation: gradientMove 3s ease-in-out infinite;
        }

        .welcome-subtitle {
            font-size: 1.3rem;
            margin-bottom: 40px;
            opacity: 0.8;
            line-height: 1.6;
        }

        .welcome-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .feature-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius);
            padding: 20px;
            transition: all 0.3s ease;
        }

        .feature-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .start-btn {
            background: var(--gradient-ai);
            border: none;
            border-radius: var(--border-radius);
            padding: 15px 40px;
            color: var(--light);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .start-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-ai);
        }
    </style>
</head>
<body>
    <!-- Welcome Screen -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-content">
            <h1 class="welcome-title">WebMaster Pro AI</h1>
            <p class="welcome-subtitle">האדיטור הויזואלי המתקדם בעולם עם בינה מלאכותית, עריכת וידאו, תמונות ועוד!</p>
            
            <div class="welcome-features">
                <div class="feature-item">
                    <div class="feature-icon">🤖</div>
                    <h3>AI מתקדם</h3>
                    <p>יצירת תוכן, צבעים ותמונות</p>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">🎬</div>
                    <h3>וידאו ומדיה</h3>
                    <p>עריכת וידאו ותמונות מובנית</p>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">📱</div>
                    <h3>רספונסיבי</h3>
                    <p>עיצוב לכל המכשירים</p>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">⚡</div>
                    <h3>עריכה חיה</h3>
                    <p>רואה שינויים בזמן אמת</p>
                </div>
            </div>
            
            <button class="start-btn" onclick="startEditor()">🚀 התחל ליצור</button>
        </div>
    </div>

    <!-- Main Editor -->
    <div class="editor-container">
        <!-- Left Toolbar -->
        <div class="left-toolbar">
            <div class="toolbar-logo">
                <i class="fas fa-magic"></i>
            </div>
            
            <div class="toolbar-section">
                <button class="toolbar-button ai" onclick="toggleAI()" title="AI Assistant">
                    <i class="fas fa-robot"></i>
                </button>
                <button class="toolbar-button" onclick="toggleSidebar('left')" title="Elements">
                    <i class="fas fa-shapes"></i>
                </button>
                <button class="toolbar-button" onclick="toggleSidebar('left')" title="Pages">
                    <i class="fas fa-copy"></i>
                </button>
            </div>
            
            <div class="toolbar-section">
                <button class="toolbar-button" onclick="toggleSidebar('left')" title="Media">
                    <i class="fas fa-photo-video"></i>
                </button>
                <button class="toolbar-button" onclick="toggleSidebar('left')" title="Text">
                    <i class="fas fa-font"></i>
                </button>
                <button class="toolbar-button" onclick="toggleSidebar('left')" title="Design">
                    <i class="fas fa-palette"></i>
                </button>
            </div>
            
            <div class="toolbar-section">
                <button class="toolbar-button" onclick="toggleProperties()" title="Properties">
                    <i class="fas fa-sliders-h"></i>
                </button>
                <button class="toolbar-button" onclick="exportWebsite()" title="Export">
                    <i class="fas fa-download"></i>
                </button>
                <button class="toolbar-button" onclick="saveWebsite()" title="Save">
                    <i class="fas fa-save"></i>
                </button>
            </div>
        </div>

        <!-- Left Sidebar -->
        <div class="left-sidebar" id="leftSidebar">
            <div class="sidebar-header">
                <h3 class="sidebar-title" id="sidebarTitle">רכיבים</h3>
                <button class="close-sidebar" onclick="toggleSidebar('left')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="sidebar-content">
                <!-- AI Section -->
                <div class="ai-section">
                    <div class="ai-title">
                        <i class="fas fa-robot"></i>
                        <span>AI Assistant</span>
                    </div>
                    <button class="ai-button" onclick="generateWithAI('content')">
                        ✨ יצירת תוכן AI
                    </button>
                    <button class="ai-button" onclick="generateWithAI('design')">
                        🎨 עיצוב אוטומטי
                    </button>
                    <button class="ai-button" onclick="generateWithAI('images')">
                        🖼️ יצירת תמונות AI
                    </button>
                </div>

                <!-- Elements Section -->
                <div class="control-section">
                    <div class="control-title">
                        <i class="fas fa-shapes"></i>
                        רכיבים בסיסיים
                    </div>
                    <div class="control-grid">
                        <div class="control-item" onclick="addElement('text')">
                            <i class="fas fa-font"></i>
                            <div>טקסט</div>
                        </div>
                        <div class="control-item" onclick="addElement('image')">
                            <i class="fas fa-image"></i>
                            <div>תמונה</div>
                        </div>
                        <div class="control-item" onclick="addElement('video')">
                            <i class="fas fa-video"></i>
                            <div>וידאו</div>
                        </div>
                        <div class="control-item" onclick="addElement('button')">
                            <i class="fas fa-mouse-pointer"></i>
                            <div>כפתור</div>
                        </div>
                        <div class="control-item" onclick="addElement('gallery')">
                            <i class="fas fa-images"></i>
                            <div>גלריה</div>
                        </div>
                        <div class="control-item" onclick="addElement('form')">
                            <i class="fas fa-wpforms"></i>
                            <div>טופס</div>
                        </div>
                    </div>
                </div>

                <!-- Advanced Elements -->
                <div class="control-section">
                    <div class="control-title">
                        <i class="fas fa-magic"></i>
                        רכיבים מתקדמים
                    </div>
                    <div class="control-grid">
                        <div class="control-item" onclick="addElement('carousel')">
                            <i class="fas fa-exchange-alt"></i>
                            <div>קרוסלה</div>
                        </div>
                        <div class="control-item" onclick="addElement('accordion')">
                            <i class="fas fa-list"></i>
                            <div>אקורדיון</div>
                        </div>
                        <div class="control-item" onclick="addElement('timeline')">
                            <i class="fas fa-stream"></i>
                            <div>ציר זמן</div>
                        </div>
                        <div class="control-item" onclick="addElement('testimonials')">
                            <i class="fas fa-quote-left"></i>
                            <div>המלצות</div>
                        </div>
                    </div>
                </div>

                <!-- Media Library -->
                <div class="control-section">
                    <div class="control-title">
                        <i class="fas fa-photo-video"></i>
                        ספריית מדיה
                    </div>
                    <div class="media-grid">
                        <div class="media-item upload" onclick="uploadMedia()">
                            <i class="fas fa-plus"></i>
                        </div>
                        <div class="media-item">
                            <i class="fas fa-image"></i>
                        </div>
                        <div class="media-item">
                            <i class="fas fa-video"></i>
                        </div>
                        <div class="media-item">
                            <i class="fas fa-file-alt"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Center Canvas -->
        <div class="center-canvas">
            <div class="canvas-header">
                <div class="page-tabs">
                    <div class="page-tab active">
                        <i class="fas fa-home"></i>
                        <span>עמוד בית</span>
                        <i class="fas fa-times" style="margin-right: 8px; opacity: 0.7; cursor: pointer;"></i>
                    </div>
                    <div class="page-tab">
                        <i class="fas fa-info-circle"></i>
                        <span>אודות</span>
                        <i class="fas fa-times" style="margin-right: 8px; opacity: 0.7; cursor: pointer;"></i>
                    </div>
                    <button class="add-page-btn" onclick="addNewPage()" title="הוסף דף חדש">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                
                <div class="canvas-controls">
                    <div class="device-preview">
                        <button class="device-btn active" onclick="setDevice('desktop')">
                            <i class="fas fa-desktop"></i>
                        </button>
                        <button class="device-btn" onclick="setDevice('tablet')">
                            <i class="fas fa-tablet-alt"></i>
                        </button>
                        <button class="device-btn" onclick="setDevice('mobile')">
                            <i class="fas fa-mobile-alt"></i>
                        </button>
                    </div>
                    
                    <button class="device-btn" onclick="previewWebsite()" title="תצוגה מקדימה">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
            </div>
            
            <div class="canvas-viewport">
                <div class="website-preview" id="websitePreview">
                    <iframe class="preview-frame" id="previewFrame" src="about:blank"></iframe>
                </div>
            </div>
        </div>

        <!-- Right Properties Panel -->
        <div class="right-panel" id="rightPanel">
            <div class="panel-tabs">
                <button class="panel-tab active" onclick="switchPropertiesTab('style')">עיצוב</button>
                <button class="panel-tab" onclick="switchPropertiesTab('content')">תוכן</button>
                <button class="panel-tab" onclick="switchPropertiesTab('advanced')">מתקדם</button>
            </div>
            
            <div class="panel-content">
                <div class="property-group">
                    <div class="property-label">צבע רקע</div>
                    <input type="color" class="property-control" value="#ffffff" onchange="updateProperty('backgroundColor', this.value)">
                </div>
                
                <div class="property-group">
                    <div class="property-label">תמונת רקע</div>
                    <button class="property-control" onclick="selectBackgroundImage()">
                        <i class="fas fa-image"></i>
                        בחר תמונת רקע
                    </button>
                </div>
                
                <div class="property-group">
                    <div class="property-label">גודל פונט</div>
                    <input type="range" class="property-control" min="8" max="72" value="16" onchange="updateProperty('fontSize', this.value + 'px')">
                </div>
                
                <div class="property-group">
                    <div class="property-label">צבע טקסט</div>
                    <input type="color" class="property-control" value="#000000" onchange="updateProperty('color', this.value)">
                </div>
                
                <div class="property-group">
                    <div class="property-label">מרווחים</div>
                    <input type="number" class="property-control" placeholder="פדינג" onchange="updateProperty('padding', this.value + 'px')">
                </div>
                
                <div class="property-group">
                    <div class="property-label">אנימציה</div>
                    <select class="property-control" onchange="updateProperty('animation', this.value)">
                        <option value="">ללא אנימציה</option>
                        <option value="fadeIn">Fade In</option>
                        <option value="slideUp">Slide Up</option>
                        <option value="zoomIn">Zoom In</option>
                        <option value="bounceIn">Bounce In</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <!-- AI Chat Interface -->
    <div class="ai-chat" id="aiChat">
        <div class="ai-chat-header">
            <div class="ai-chat-title">🤖 AI Assistant</div>
            <button class="close-sidebar" onclick="toggleAI()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="ai-chat-messages" id="aiMessages">
            <div class="ai-message ai">
                שלום! אני עוזר AI של WebMaster Pro. איך אוכל לעזור לך היום?
                <br><br>
                אני יכול:
                <br>• ליצור תוכן לאתר
                <br>• להציע עיצובים
                <br>• ליצור תמונות
                <br>• לכתוב קוד
            </div>
        </div>
        
        <div class="ai-chat-input">
            <div class="ai-input-group">
                <input type="text" class="ai-input" id="aiInput" placeholder="שאל אותי משהו..." onkeypress="if(event.key === 'Enter') sendAIMessage()">
                <button class="ai-send-btn" onclick="sendAIMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Floating Action Menu -->
    <div class="floating-menu">
        <button class="floating-btn" onclick="toggleAI()" title="AI Assistant">
            <i class="fas fa-robot"></i>
        </button>
    </div>

    <script>
        // ========== Global Variables ==========
        let currentPage = 'home';
        let selectedElement = null;
        let currentDevice = 'desktop';
        let isDragging = false;
        let pages = ['home', 'about'];
        let websiteData = {
            title: 'אתר חדש',
            pages: {
                home: { title: 'עמוד בית', content: '' },
                about: { title: 'אודות', content: '' }
            }
        };

        // ========== Core Functions ==========
        function startEditor() {
            document.getElementById('welcomeScreen').style.display = 'none';
            showNotification('ברוכים הבאים ל-WebMaster Pro AI!', 'success');
            initializeEditor();
        }

        function initializeEditor() {
            loadDefaultTemplate();
            setupDragAndDrop();
            setupKeyboardShortcuts();
            
            // Initialize preview frame
            const frame = document.getElementById('previewFrame');
            frame.onload = function() {
                makeFrameEditable();
            };
        }

        function loadDefaultTemplate() {
            const defaultHTML = `
                <!DOCTYPE html>
                <html lang="he" dir="rtl">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>האתר החדש שלי</title>
                    <style>
                        * { margin: 0; padding: 0; box-sizing: border-box; }
                        body { font-family: 'Inter', Arial, sans-serif; line-height: 1.6; }
                        .editable { min-height: 20px; outline: none; transition: all 0.3s ease; }
                        .editable:hover { background: rgba(102, 126, 234, 0.1); }
                        .editable.selected { outline: 2px solid #667eea; background: rgba(102, 126, 234, 0.2); }
                        .hero { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 100px 20px; text-align: center; }
                        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
                        .section { padding: 80px 20px; }
                        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; }
                    </style>
                </head>
                <body>
                    <header class="hero">
                        <div class="container">
                            <h1 class="editable" data-element="title">ברוכים הבאים לאתר שלי</h1>
                            <p class="editable" data-element="subtitle">תיאור קצר ומעניין על העסק שלך</p>
                            <button class="editable" data-element="cta" style="background: white; color: #667eea; padding: 15px 30px; border: none; border-radius: 25px; font-weight: 600; margin-top: 20px; cursor: pointer;">צור קשר</button>
                        </div>
                    </header>
                    
                    <section class="section">
                        <div class="container">
                            <h2 class="editable" data-element="services-title" style="text-align: center; margin-bottom: 50px; font-size: 2.5em; color: #333;">השירותים שלנו</h2>
                            <div class="grid">
                                <div class="editable" data-element="service1" style="text-align: center; padding: 30px; background: #f8f9fa; border-radius: 15px;">
                                    <div style="font-size: 3em; margin-bottom: 20px;">⭐</div>
                                    <h3>שירות מקצועי</h3>
                                    <p>תיאור השירות הראשון</p>
                                </div>
                                <div class="editable" data-element="service2" style="text-align: center; padding: 30px; background: #f8f9fa; border-radius: 15px;">
                                    <div style="font-size: 3em; margin-bottom: 20px;">🎯</div>
                                    <h3>פתרונות מותאמים</h3>
                                    <p>תיאור השירות השני</p>
                                </div>
                                <div class="editable" data-element="service3" style="text-align: center; padding: 30px; background: #f8f9fa; border-radius: 15px;">
                                    <div style="font-size: 3em; margin-bottom: 20px;">💎</div>
                                    <h3>איכות מעולה</h3>
                                    <p>תיאור השירות השלישי</p>
                                </div>
                            </div>
                        </div>
                    </section>
                    
                    <footer style="background: #333; color: white; padding: 40px 20px; text-align: center;">
                        <div class="container">
                            <h3 class="editable" data-element="contact-title">צרו קשר</h3>
                            <p class="editable" data-element="phone">📞 052-1234567</p>
                            <p class="editable" data-element="email">✉️ info@mywebsite.co.il</p>
                        </div>
                    </footer>
                    
                    <script>
                        // Make elements editable and selectable
                        document.addEventListener('DOMContentLoaded', function() {
                            const editables = document.querySelectorAll('.editable');
                            editables.forEach(element => {
                                element.addEventListener('click', function(e) {
                                    e.stopPropagation();
                                    selectElement(this);
                                });
                            });
                        });
                        
                        function selectElement(element) {
                            // Remove previous selection
                            const selected = document.querySelector('.editable.selected');
                            if (selected) selected.classList.remove('selected');
                            
                            // Select new element
                            element.classList.add('selected');
                            
                            // Notify parent window
                            if (window.parent !== window) {
                                window.parent.onElementSelected(element);
                            }
                        }
                    </script>
                </body>
                </html>
            `;
            
            const frame = document.getElementById('previewFrame');
            frame.srcdoc = defaultHTML;
        }

        function makeFrameEditable() {
            const frame = document.getElementById('previewFrame');
            const doc = frame.contentDocument;
            
            if (doc) {
                // Add double-click to edit functionality
                doc.addEventListener('dblclick', function(e) {
                    const element = e.target;
                    if (element.classList.contains('editable')) {
                        element.contentEditable = true;
                        element.focus();
                        selectText(element);
                    }
                });
                
                // Save on blur
                doc.addEventListener('blur', function(e) {
                    if (e.target.contentEditable === 'true') {
                        e.target.contentEditable = false;
                        showNotification('תוכן נשמר', 'success');
                    }
                }, true);
            }
        }

        function onElementSelected(element) {
            selectedElement = element;
            updatePropertiesPanel(element);
            showNotification('אלמנט נבחר', 'success');
        }

        function selectText(element) {
            const range = document.createRange();
            range.selectNodeContents(element);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
        }

        // ========== Sidebar Functions ==========
        function toggleSidebar(side) {
            const sidebar = document.getElementById('leftSidebar');
            if (side === 'left') {
                sidebar.classList.toggle('active');
            }
        }

        function toggleProperties() {
            const panel = document.getElementById('rightPanel');
            panel.classList.toggle('active');
        }

        function switchPropertiesTab(tab) {
            const tabs = document.querySelectorAll('.panel-tab');
            tabs.forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update properties content based on tab
            showNotification(`עבר לטאב ${tab}`, 'success');
        }

        function updatePropertiesPanel(element) {
            if (!element) return;
            
            const styles = element.style;
            const computed = window.getComputedStyle(element);
            
            // Update property controls with element values
            // This would be expanded with actual property binding
        }

        // ========== AI Functions ==========
        function toggleAI() {
            const aiChat = document.getElementById('aiChat');
            aiChat.classList.toggle('active');
        }

        function generateWithAI(type) {
            showNotification('🤖 AI מייצר תוכן...', 'success');
            
            // Simulate AI generation
            setTimeout(() => {
                switch(type) {
                    case 'content':
                        addAIMessage('נוצר תוכן חדש עבורך! הוספתי כותרות ותיאורים מקצועיים.');
                        break;
                    case 'design':
                        addAIMessage('בחרתי פלטת צבעים מושלמת ועיצוב מודרני עבור האתר שלך.');
                        break;
                    case 'images':
                        addAIMessage('יצרתי תמונות מותאמות אישית עבור האתר שלך.');
                        break;
                }
                showNotification('AI סיים ליצור!', 'success');
            }, 2000);
        }

        function sendAIMessage() {
            const input = document.getElementById('aiInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            addMessage(message, 'user');
            input.value = '';
            
            // Simulate AI response
            setTimeout(() => {
                const responses = [
                    'זה רעיון מעולה! אני יכול לעזור לך ליישם את זה.',
                    'בואו ניצור משהו מדהים יחד! איך תרצה להמשיך?',
                    'הבנתי מה אתה מחפש. אני אתחיל לעבוד על זה.',
                    'זה יהיה נראה נהדר! אני מוסיף את זה לאתר.'
                ];
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                addAIMessage(randomResponse);
            }, 1000);
        }

        function addMessage(text, sender) {
            const messages = document.getElementById('aiMessages');
            const message = document.createElement('div');
            message.className = `ai-message ${sender}`;
            message.textContent = text;
            messages.appendChild(message);
            messages.scrollTop = messages.scrollHeight;
        }

        function addAIMessage(text) {
            addMessage(text, 'ai');
        }

        // ========== Element Functions ==========
        function addElement(type) {
            const frame = document.getElementById('previewFrame');
            const doc = frame.contentDocument;
            
            if (!doc) return;
            
            let elementHTML = '';
            
            switch(type) {
                case 'text':
                    elementHTML = '<h2 class="editable" style="margin: 20px 0;">טקסט חדש</h2>';
                    break;
                case 'image':
                    elementHTML = '<img class="editable" src="https://via.placeholder.com/300x200" style="max-width: 100%; margin: 20px 0;" alt="תמונה חדשה">';
                    break;
                case 'video':
                    elementHTML = '<div class="editable" style="margin: 20px 0; background: #f0f0f0; padding: 50px; text-align: center; border-radius: 10px;"><i class="fas fa-video" style="font-size: 3em; color: #666;"></i><br>וידאו - לחץ לעריכה</div>';
                    break;
                case 'button':
                    elementHTML = '<button class="editable" style="background: #667eea; color: white; padding: 15px 30px; border: none; border-radius: 25px; margin: 20px 0; cursor: pointer;">כפתור חדש</button>';
                    break;
                case 'gallery':
                    elementHTML = '<div class="editable" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 20px 0;"><img src="https://via.placeholder.com/200x150" style="width: 100%; border-radius: 8px;"><img src="https://via.placeholder.com/200x150" style="width: 100%; border-radius: 8px;"><img src="https://via.placeholder.com/200x150" style="width: 100%; border-radius: 8px;"></div>';
                    break;
                default:
                    elementHTML = `<div class="editable" style="margin: 20px 0; padding: 20px; background: #f8f9fa; border-radius: 10px;">רכיב ${type} חדש</div>`;
            }
            
            // Add to current selection or end of body
            const container = doc.querySelector('.container') || doc.body;
            container.insertAdjacentHTML('beforeend', elementHTML);
            
            showNotification(`רכיב ${type} נוסף בהצלחה!`, 'success');
            makeFrameEditable();
        }

        function updateProperty(property, value) {
            if (!selectedElement) {
                showNotification('בחר אלמנט לעריכה', 'warning');
                return;
            }
            
            selectedElement.style[property] = value;
            showNotification('מאפיין עודכן', 'success');
        }

        // ========== Device & Preview Functions ==========
        function setDevice(device) {
            currentDevice = device;
            
            const preview = document.getElementById('websitePreview');
            const buttons = document.querySelectorAll('.device-btn');
            
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            preview.className = `website-preview ${device}`;
            
            showNotification(`תצוגה שונתה ל-${device}`, 'success');
        }

        function previewWebsite() {
            const frame = document.getElementById('previewFrame');
            const newWindow = window.open('', '_blank');
            newWindow.document.write(frame.srcdoc || frame.contentDocument.documentElement.outerHTML);
            newWindow.document.close();
            
            showNotification('נפתחת תצוגה מקדימה', 'success');
        }

        // ========== Page Management ==========
        function addNewPage() {
            const pageName = prompt('הכנס שם לדף החדש:');
            if (!pageName) return;
            
            const pageId = pageName.toLowerCase().replace(/\s+/g, '-');
            pages.push(pageId);
            websiteData.pages[pageId] = { title: pageName, content: '' };
            
            // Add page tab
            const tabs = document.querySelector('.page-tabs');
            const newTab = document.createElement('div');
            newTab.className = 'page-tab';
            newTab.innerHTML = `
                <i class="fas fa-file"></i>
                <span>${pageName}</span>
                <i class="fas fa-times" style="margin-right: 8px; opacity: 0.7; cursor: pointer;" onclick="removePage('${pageId}')"></i>
            `;
            newTab.onclick = () => switchPage(pageId);
            
            tabs.insertBefore(newTab, tabs.lastElementChild);
            
            showNotification(`דף "${pageName}" נוסף בהצלחה!`, 'success');
        }

        function switchPage(pageId) {
            currentPage = pageId;
            
            // Update active tab
            const tabs = document.querySelectorAll('.page-tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            // Load page content
            loadPageContent(pageId);
            
            showNotification(`עבר לדף ${websiteData.pages[pageId].title}`, 'success');
        }

        function loadPageContent(pageId) {
            // This would load the specific page content
            // For now, we'll just show a notification
            showNotification(`טוען תוכן דף ${pageId}...`, 'success');
        }

        // ========== Media Functions ==========
        function uploadMedia() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*,video/*';
            input.multiple = true;
            
            input.onchange = function(e) {
                const files = Array.from(e.target.files);
                files.forEach(file => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        // Add to media library
                        addToMediaLibrary(file.name, e.target.result, file.type);
                    };
                    reader.readAsDataURL(file);
                });
                
                showNotification(`הועלו ${files.length} קבצים`, 'success');
            };
            
            input.click();
        }

        function addToMediaLibrary(name, src, type) {
            const mediaGrid = document.querySelector('.media-grid');
            const mediaItem = document.createElement('div');
            mediaItem.className = 'media-item';
            
            if (type.startsWith('image/')) {
                mediaItem.style.backgroundImage = `url(${src})`;
                mediaItem.style.backgroundSize = 'cover';
                mediaItem.style.backgroundPosition = 'center';
            } else if (type.startsWith('video/')) {
                mediaItem.innerHTML = '<i class="fas fa-video"></i>';
            }
            
            mediaItem.onclick = () => insertMedia(src, type);
            mediaGrid.appendChild(mediaItem);
        }

        function insertMedia(src, type) {
            if (type.startsWith('image/')) {
                addElement('image');
                // Set the image source
                setTimeout(() => {
                    const frame = document.getElementById('previewFrame');
                    const doc = frame.contentDocument;
                    const lastImg = doc.querySelector('img:last-of-type');
                    if (lastImg) lastImg.src = src;
                }, 100);
            }
            
            showNotification('מדיה הוכנסה לאתר', 'success');
        }

        function selectBackgroundImage() {
            uploadMedia();
        }

        // ========== Save & Export Functions ==========
        function saveWebsite() {
            const frame = document.getElementById('previewFrame');
            const content = frame.srcdoc || frame.contentDocument.documentElement.outerHTML;
            
            // Save to localStorage
            localStorage.setItem('webmaster_pro_website', content);
            localStorage.setItem('webmaster_pro_data', JSON.stringify(websiteData));
            
            showNotification('האתר נשמר בהצלחה!', 'success');
        }

        function exportWebsite() {
            const frame = document.getElementById('previewFrame');
            const content = frame.srcdoc || frame.contentDocument.documentElement.outerHTML;
            
            const blob = new Blob([content], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'my-website.html';
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('האתר יוצא בהצלחה!', 'success');
        }

        // ========== Utility Functions ==========
        function setupDragAndDrop() {
            // Implement drag and drop functionality
            // This would be a complex implementation
        }

        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key) {
                        case 's':
                            e.preventDefault();
                            saveWebsite();
                            break;
                        case 'z':
                            e.preventDefault();
                            // Implement undo
                            showNotification('ביטול פעולה', 'success');
                            break;
                        case 'y':
                            e.preventDefault();
                            // Implement redo
                            showNotification('חזרה על פעולה', 'success');
                            break;
                    }
                }
            });
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // ========== Initialize ==========
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 WebMaster Pro AI Editor מוכן!');
        });

        // Handle frame communication
        window.onElementSelected = onElementSelected;
    </script>
</body>
</html>
