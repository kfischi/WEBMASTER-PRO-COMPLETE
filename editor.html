<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebMaster Pro Visual Editor Ultimate</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Assistant:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --accent: #f093fb;
            --success: #00d4aa;
            --warning: #ffc107;
            --danger: #ff3d71;
            --dark: #0f0f23;
            --dark-secondary: #1a1a2e;
            --light: #f8f9fa;
            --glass: rgba(255, 255, 255, 0.1);
            --glass-dark: rgba(0, 0, 0, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            --shadow-strong: 0 20px 40px rgba(0, 0, 0, 0.2);
            --gradient: linear-gradient(135deg, var(--primary), var(--secondary));
            --gradient-accent: linear-gradient(135deg, var(--accent), var(--primary));
            --gradient-dark: linear-gradient(135deg, var(--dark), var(--dark-secondary));
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Assistant', sans-serif;
            background: var(--gradient-dark);
            min-height: 100vh;
            color: white;
            overflow: hidden;
        }

        /* Advanced Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .loading-screen.hidden {
            opacity: 0;
            transform: scale(1.1);
            pointer-events: none;
        }

        .loading-content {
            text-align: center;
            animation: slideInUp 1s ease;
        }

        .loading-logo {
            font-size: 4rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #fff, #f093fb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: glow 3s ease-in-out infinite;
        }

        .loading-text {
            font-size: 1.5rem;
            margin-bottom: 2rem;
            opacity: 0.9;
            font-weight: 600;
        }

        .loading-progress {
            width: 300px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
            margin: 2rem auto;
        }

        .loading-bar {
            height: 100%;
            background: linear-gradient(90deg, #fff, #f093fb);
            width: 0%;
            border-radius: 2px;
            animation: loadingProgress 3s ease-in-out;
        }

        @keyframes slideInUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 20px rgba(240, 147, 251, 0.5)); }
            50% { filter: drop-shadow(0 0 40px rgba(240, 147, 251, 0.8)); }
        }

        @keyframes loadingProgress {
            0% { width: 0%; }
            100% { width: 100%; }
        }

        /* Main Layout */
        .editor-container {
            display: grid;
            grid-template-areas: 
                "header header header"
                "sidebar main toolbar"
                "footer footer footer";
            grid-template-columns: 350px 1fr 280px;
            grid-template-rows: 70px 1fr 50px;
            height: 100vh;
            gap: 1px;
            background: var(--dark);
        }

        /* Top Header */
        .top-header {
            grid-area: header;
            background: var(--glass);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            box-shadow: var(--shadow);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.4rem;
            font-weight: 800;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .website-selector {
            position: relative;
        }

        .current-website {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .current-website:hover {
            background: var(--gradient-accent);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .website-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            margin-top: 0.5rem;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1000;
            max-height: 400px;
            overflow-y: auto;
        }

        .website-dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .website-option {
            padding: 1rem;
            border-bottom: 1px solid var(--glass-border);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .website-option:last-child {
            border-bottom: none;
        }

        .website-option:hover {
            background: var(--gradient-accent);
        }

        .website-info {
            flex: 1;
        }

        .website-name {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .website-type {
            font-size: 0.85rem;
            opacity: 0.7;
        }

        .website-price {
            font-weight: 700;
            color: var(--success);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-button {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .header-button:hover {
            background: var(--gradient);
            border-color: transparent;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .header-button.primary {
            background: var(--gradient);
            border-color: transparent;
        }

        .header-button.success {
            background: linear-gradient(135deg, var(--success), #00a085);
            border-color: transparent;
        }

        /* Left Sidebar - Tools */
        .left-sidebar {
            grid-area: sidebar;
            background: var(--glass);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--glass-border);
            overflow-y: auto;
            padding: 1.5rem;
        }

        .tool-category {
            margin-bottom: 2rem;
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.8;
        }

        .tool-grid {
            display: grid;
            gap: 0.75rem;
        }

        .tool-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .tool-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--gradient-accent);
            opacity: 0.1;
            transition: all 0.3s ease;
        }

        .tool-item:hover::before {
            left: 0;
        }

        .tool-item:hover {
            border-color: var(--primary);
            transform: translateX(-5px);
            box-shadow: var(--shadow);
        }

        .tool-item.active {
            background: var(--gradient);
            border-color: transparent;
        }

        .tool-icon {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        .tool-info {
            flex: 1;
        }

        .tool-name {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .tool-desc {
            font-size: 0.85rem;
            opacity: 0.7;
        }

        /* Main Content Area */
        .main-content {
            grid-area: main;
            background: white;
            position: relative;
            overflow: hidden;
        }

        .content-header {
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .content-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: #333;
            font-weight: 600;
        }

        .device-switcher {
            display: flex;
            background: white;
            border-radius: 8px;
            padding: 0.25rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .device-option {
            padding: 0.5rem 1rem;
            border: none;
            background: none;
            color: #666;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .device-option.active {
            background: var(--gradient);
            color: white;
        }

        .content-frame {
            height: calc(100% - 60px);
            position: relative;
            overflow: auto;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        .website-container {
            width: 100%;
            min-height: 100%;
            transition: all 0.3s ease;
            padding: 2rem;
        }

        .website-container.mobile {
            max-width: 375px;
            margin: 0 auto;
        }

        .website-container.tablet {
            max-width: 768px;
            margin: 0 auto;
        }

        /* Right Toolbar - Properties */
        .right-toolbar {
            grid-area: toolbar;
            background: var(--glass);
            backdrop-filter: blur(20px);
            border-left: 1px solid var(--glass-border);
            overflow-y: auto;
            padding: 1.5rem;
        }

        .properties-panel {
            display: none;
        }

        .properties-panel.active {
            display: block;
            animation: slideInRight 0.3s ease;
        }

        .panel-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            font-weight: 700;
        }

        .property-group {
            margin-bottom: 2rem;
        }

        .property-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .property-input {
            width: 100%;
            padding: 0.75rem;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            color: white;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .property-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.3);
        }

        .property-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .color-picker-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .color-option {
            width: 35px;
            height: 35px;
            border-radius: 8px;
            border: 2px solid var(--glass-border);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .color-option:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow);
        }

        .color-option.active::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            text-shadow: 0 0 3px rgba(0,0,0,0.8);
        }

        .property-button {
            width: 100%;
            padding: 0.75rem;
            background: var(--gradient);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .property-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        /* Footer Status Bar */
        .footer {
            grid-area: footer;
            background: var(--glass);
            backdrop-filter: blur(20px);
            border-top: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            font-size: 0.85rem;
        }

        .status-left {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            opacity: 0.8;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Website Loading Area */
        .website-loader {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #666;
        }

        .loader-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Editable Elements Styles */
        .editable-element {
            position: relative;
            outline: 2px dashed transparent;
            transition: all 0.3s ease;
            border-radius: 4px;
            margin: 2px;
            padding: 4px;
        }

        .editable-element:hover {
            outline-color: var(--primary);
            background: rgba(102, 126, 234, 0.05);
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.2);
        }

        .editable-element.selected {
            outline-color: var(--success);
            background: rgba(0, 212, 170, 0.1);
            box-shadow: 0 0 15px rgba(0, 212, 170, 0.3);
        }

        .element-label {
            position: absolute;
            top: -25px;
            left: 0;
            background: var(--dark);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            opacity: 0;
            transform: translateY(5px);
            transition: all 0.3s ease;
            pointer-events: none;
            z-index: 100;
        }

        .editable-element:hover .element-label {
            opacity: 1;
            transform: translateY(0);
        }

        /* Success/Error Messages */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 1rem 2rem;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            z-index: 10001;
            opacity: 0;
            transform: translateX(-50%) translateY(-20px);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .notification.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        .notification.success {
            background: linear-gradient(135deg, var(--success), #00a085);
        }

        .notification.error {
            background: linear-gradient(135deg, var(--danger), #cc2952);
        }

        .notification.warning {
            background: linear-gradient(135deg, var(--warning), #d49502);
        }

        /* Advanced Animations */
        @keyframes slideInRight {
            from {
                transform: translateX(20px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .editor-container {
                grid-template-columns: 280px 1fr 250px;
            }
        }

        @media (max-width: 768px) {
            .editor-container {
                grid-template-areas: 
                    "header"
                    "main"
                    "footer";
                grid-template-columns: 1fr;
                grid-template-rows: 70px 1fr 50px;
            }
            
            .left-sidebar,
            .right-toolbar {
                position: fixed;
                top: 70px;
                bottom: 50px;
                width: 280px;
                z-index: 1000;
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .left-sidebar.active,
            .right-toolbar.active {
                transform: translateX(0);
            }
            
            .right-toolbar {
                right: 0;
                transform: translateX(100%);
            }
            
            .right-toolbar.active {
                transform: translateX(0);
            }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--glass);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gradient);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--gradient-accent);
        }
    </style>
</head>
<body>
    <!-- Advanced Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-content">
            <div class="loading-logo">
                <i class="fas fa-magic"></i>
            </div>
            <div class="loading-text">WebMaster Pro Visual Editor Ultimate</div>
            <div class="loading-progress">
                <div class="loading-bar"></div>
            </div>
            <div style="font-size: 1rem; opacity: 0.7; margin-top: 1rem;">
                טוען את המערכת המתקדמת ביותר לעריכת אתרים...
            </div>
        </div>
    </div>

    <!-- Main Editor Container -->
    <div class="editor-container">
        <!-- Top Header -->
        <div class="top-header">
            <div class="header-left">
                <div class="logo">
                    <i class="fas fa-magic"></i>
                    <span>WebMaster Pro</span>
                </div>
                
                <div class="website-selector">
                    <div class="current-website" id="currentWebsite">
                        <i class="fas fa-globe"></i>
                        <span>בחר אתר לעריכה</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="website-dropdown" id="websiteDropdown">
                        <!-- Websites will be loaded here -->
                    </div>
                </div>
            </div>
            
            <div class="header-actions">
                <button class="header-button" id="undoBtn">
                    <i class="fas fa-undo"></i>
                    <span>ביטול</span>
                </button>
                <button class="header-button" id="redoBtn">
                    <i class="fas fa-redo"></i>
                    <span>חזרה</span>
                </button>
                <button class="header-button" id="previewBtn">
                    <i class="fas fa-eye"></i>
                    <span>תצוגה מקדימה</span>
                </button>
                <button class="header-button primary" id="saveBtn">
                    <i class="fas fa-save"></i>
                    <span>שמירה</span>
                </button>
                <button class="header-button success" id="exportBtn">
                    <i class="fas fa-download"></i>
                    <span>ייצוא</span>
                </button>
            </div>
        </div>

        <!-- Left Sidebar - Tools -->
        <div class="left-sidebar" id="leftSidebar">
            <div class="tool-category">
                <div class="category-header">
                    <i class="fas fa-edit"></i>
                    <span>עריכת תוכן</span>
                </div>
                <div class="tool-grid">
                    <div class="tool-item active" data-tool="select">
                        <i class="fas fa-mouse-pointer tool-icon"></i>
                        <div class="tool-info">
                            <div class="tool-name">בחירה</div>
                            <div class="tool-desc">בחר אלמנטים לעריכה</div>
                        </div>
                    </div>
                    <div class="tool-item" data-tool="text">
                        <i class="fas fa-font tool-icon"></i>
                        <div class="tool-info">
                            <div class="tool-name">טקסט</div>
                            <div class="tool-desc">ערוך טקסטים וכותרות</div>
                        </div>
                    </div>
                    <div class="tool-item" data-tool="image">
                        <i class="fas fa-image tool-icon"></i>
                        <div class="tool-info">
                            <div class="tool-name">תמונות</div>
                            <div class="tool-desc">החלף והעלה תמונות</div>
                        </div>
                    </div>
                    <div class="tool-item" data-tool="color">
                        <i class="fas fa-palette tool-icon"></i>
                        <div class="tool-info">
                            <div class="tool-name">צבעים</div>
                            <div class="tool-desc">שנה צבעי האתר</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tool-category">
                <div class="category-header">
                    <i class="fas fa-layer-group"></i>
                    <span>רכיבים</span>
                </div>
                <div class="tool-grid">
                    <div class="tool-item" data-tool="button">
                        <i class="fas fa-hand-pointer tool-icon"></i>
                        <div class="tool-info">
                            <div class="tool-name">כפתורים</div>
                            <div class="tool-desc">הוסף ערוך כפתורים</div>
                        </div>
                    </div>
                    <div class="tool-item" data-tool="form">
                        <i class="fas fa-wpforms tool-icon"></i>
                        <div class="tool-info">
                            <div class="tool-name">טפסים</div>
                            <div class="tool-desc">צור וערוך טפסים</div>
                        </div>
                    </div>
                    <div class="tool-item" data-tool="section">
                        <i class="fas fa-th-large tool-icon"></i>
                        <div class="tool-info">
                            <div class="tool-name">סקציות</div>
                            <div class="tool-desc">נהל סקציות האתר</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tool-category">
                <div class="category-header">
                    <i class="fas fa-cog"></i>
                    <span>הגדרות מתקדמות</span>
                </div>
                <div class="tool-grid">
                    <div class="tool-item" data-tool="seo">
                        <i class="fas fa-search tool-icon"></i>
                        <div class="tool-info">
                            <div class="tool-name">SEO</div>
                            <div class="tool-desc">אופטימיזציה למנועי חיפוש</div>
                        </div>
                    </div>
                    <div class="tool-item" data-tool="responsive">
                        <i class="fas fa-mobile-alt tool-icon"></i>
                        <div class="tool-info">
                            <div class="tool-name">רספונסיבי</div>
                            <div class="tool-desc">התאמה למכשירים</div>
                        </div>
                    </div>
                    <div class="tool-item" data-tool="analytics">
                        <i class="fas fa-chart-line tool-icon"></i>
                        <div class="tool-info">
                            <div class="tool-name">אנליטיקס</div>
                            <div class="tool-desc">מעקב וסטטיסטיקות</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="content-header">
                <div class="content-title">
                    <i class="fas fa-browser"></i>
                    <span id="currentSiteName">אתר לא נבחר</span>
                </div>
                <div class="device-switcher">
                    <button class="device-option active" data-device="desktop">
                        <i class="fas fa-desktop"></i>
                        <span>דסקטופ</span>
                    </button>
                    <button class="device-option" data-device="tablet">
                        <i class="fas fa-tablet-alt"></i>
                        <span>טאבלט</span>
                    </button>
                    <button class="device-option" data-device="mobile">
                        <i class="fas fa-mobile-alt"></i>
                        <span>מובייל</span>
                    </button>
                </div>
            </div>
            <div class="content-frame">
                <div class="website-loader" id="websiteLoader">
                    <i class="fas fa-globe loader-icon"></i>
                    <h3>ברוכים הבאים ל-WebMaster Pro</h3>
                    <p>בחרו אתר מהתפריט העליון כדי להתחיל לערוך</p>
                </div>
                <div class="website-container" id="websiteContainer" style="display: none;">
                    <!-- Website content will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Right Toolbar - Properties -->
        <div class="right-toolbar" id="rightToolbar">
            <!-- Text Properties Panel -->
            <div class="properties-panel active" id="textPanel">
                <div class="panel-header">
                    <i class="fas fa-font"></i>
                    <span>מאפיני טקסט</span>
                </div>
                <div class="property-group">
                    <label class="property-label">תוכן הטקסט</label>
                    <textarea class="property-input" id="textContent" rows="3" placeholder="הכנס טקסט..."></textarea>
                </div>
                <div class="property-group">
                    <label class="property-label">גודל טקסט</label>
                    <select class="property-input" id="fontSize">
                        <option value="0.8rem">קטן מאוד</option>
                        <option value="1rem">רגיל</option>
                        <option value="1.2rem">גדול</option>
                        <option value="1.5rem">גדול יותר</option>
                        <option value="2rem">ענק</option>
                        <option value="2.5rem">ענק מאוד</option>
                    </select>
                </div>
                <div class="property-group">
                    <label class="property-label">משקל טקסט</label>
                    <select class="property-input" id="fontWeight">
                        <option value="300">דק</option>
                        <option value="400">רגיל</option>
                        <option value="600">מודגש</option>
                        <option value="700">מודגש מאוד</option>
                        <option value="800">כבד</option>
                    </select>
                </div>
                <div class="property-group">
                    <label class="property-label">צבע טקסט</label>
                    <input type="color" class="property-input" id="textColor" value="#333333">
                </div>
                <button class="property-button" onclick="applyTextProperties()">
                    <i class="fas fa-check"></i>
                    החל שינויים
                </button>
            </div>

            <!-- Image Properties Panel -->
            <div class="properties-panel" id="imagePanel">
                <div class="panel-header">
                    <i class="fas fa-image"></i>
                    <span>מאפיני תמונה</span>
                </div>
                <div class="property-group">
                    <label class="property-label">URL תמונה</label>
                    <input type="url" class="property-input" id="imageUrl" placeholder="https://example.com/image.jpg">
                </div>
                <div class="property-group">
                    <label class="property-label">טקסט חלופי</label>
                    <input type="text" class="property-input" id="imageAlt" placeholder="תיאור התמונה">
                </div>
                <div class="property-group">
                    <label class="property-label">העלאת תמונה</label>
                    <input type="file" class="property-input" id="imageFile" accept="image/*">
                </div>
                <button class="property-button" onclick="applyImageProperties()">
                    <i class="fas fa-check"></i>
                    החל שינויים
                </button>
            </div>

            <!-- Color Properties Panel -->
            <div class="properties-panel" id="colorPanel">
                <div class="panel-header">
                    <i class="fas fa-palette"></i>
                    <span>ערכת צבעים</span>
                </div>
                <div class="property-group">
                    <label class="property-label">צבע ראשי</label>
                    <input type="color" class="property-input" id="primaryColor" value="#8b5a8c">
                    <div class="color-picker-grid">
                        <div class="color-option" style="background: #8b5a8c" data-color="#8b5a8c"></div>
                        <div class="color-option" style="background: #667eea" data-color="#667eea"></div>
                        <div class="color-option" style="background: #764ba2" data-color="#764ba2"></div>
                        <div class="color-option" style="background: #f093fb" data-color="#f093fb"></div>
                        <div class="color-option" style="background: #4facfe" data-color="#4facfe"></div>
                    </div>
                </div>
                <div class="property-group">
                    <label class="property-label">צבע משני</label>
                    <input type="color" class="property-input" id="secondaryColor" value="#d4af37">
                </div>
                <div class="property-group">
                    <label class="property-label">צבע הדגשה</label>
                    <input type="color" class="property-input" id="accentColor" value="#00d4aa">
                </div>
                <button class="property-button" onclick="applyColorScheme()">
                    <i class="fas fa-check"></i>
                    החל ערכת צבעים
                </button>
            </div>
        </div>

        <!-- Footer Status Bar -->
        <div class="footer">
            <div class="status-left">
                <div class="status-item">
                    <div class="status-indicator"></div>
                    <span>מערכת פעילה</span>
                </div>
                <div class="status-item">
                    <i class="fas fa-save"></i>
                    <span id="saveStatus">לא נשמר</span>
                </div>
                <div class="status-item">
                    <i class="fas fa-users"></i>
                    <span>משתמש אחד מחובר</span>
                </div>
            </div>
            <div class="status-right">
                WebMaster Pro Visual Editor Ultimate v3.0
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span></span>
    </div>

    <script>
        // WebMaster Pro Visual Editor Ultimate
        class WebMasterProEditor {
            constructor() {
                this.currentWebsite = null;
                this.currentTool = 'select';
                this.selectedElement = null;
                this.websiteData = {};
                this.history = [];
                this.historyIndex = -1;
                this.isEditing = false;
                this.availableWebsites = [
                    { id: 'dr-michal-rosen', name: 'ד"ר מיכל רוזן', type: 'אסתטיקה רפואית', price: '₪2,800' },
                    { id: 'law-firm', name: 'משרד עורכי דין', type: 'שירותים משפטיים', price: '₪2,500' },
                    { id: 'fitness-co', name: 'מאמן כושר', type: 'ספורט ובריאות', price: '₪2,200' },
                    { id: 'yoga-studio', name: 'יוגה ומדיטציה', type: 'בריאות ורוגע', price: '₪1,900' },
                    { id: 'nutritionist', name: 'תזונאית קלינית', type: 'בריאות ותזונה', price: '₪2,400' },
                    { id: 'accountant', name: 'חשבת שכר', type: 'שירותים כלכליים', price: '₪2,000' },
                    { id: 'beauty-salon', name: 'מספרה ויופי', type: 'יופי וטיפוח', price: '₪1,700' },
                    { id: 'tutor', name: 'מורה פרטית', type: 'חינוך', price: '₪2,100' },
                    { id: 'aesthetic-clinic', name: 'קליניקת יופי פרמיום', type: 'אסתטיקה מתקדמת', price: '₪3,200' },
                    { id: 'multibrawn', name: 'נופש ואירועים', type: 'תיירות ופנאי', price: '₪2,300' },
                    { id: 'real-estate', name: 'נדל"ן פרמיום', type: 'נדל"ן יוקרה', price: '₪2,700' }
                ];
                this.init();
            }

            init() {
                console.log('🚀 WebMaster Pro Visual Editor Ultimate v3.0 מאותחל...');
                this.setupLoadingScreen();
                this.setupEventListeners();
                this.setupWebsiteDropdown();
                this.setupToolSelection();
                this.setupKeyboardShortcuts();
            }

            setupLoadingScreen() {
                setTimeout(() => {
                    document.getElementById('loadingScreen').classList.add('hidden');
                    this.showNotification('WebMaster Pro מוכן לשימוש! 🚀', 'success');
                }, 3000);
            }

            setupEventListeners() {
                // Header buttons
                document.getElementById('saveBtn').addEventListener('click', () => this.saveWebsite());
                document.getElementById('previewBtn').addEventListener('click', () => this.previewWebsite());
                document.getElementById('exportBtn').addEventListener('click', () => this.exportWebsite());
                document.getElementById('undoBtn').addEventListener('click', () => this.undo());
                document.getElementById('redoBtn').addEventListener('click', () => this.redo());

                // Website selector
                document.getElementById('currentWebsite').addEventListener('click', () => {
                    document.getElementById('websiteDropdown').classList.toggle('active');
                });

                // Device switcher
                document.querySelectorAll('.device-option').forEach(option => {
                    option.addEventListener('click', (e) => this.switchDevice(e.target.dataset.device));
                });

                // Auto-save
                setInterval(() => this.autoSave(), 30000);
            }

            setupWebsiteDropdown() {
                const dropdown = document.getElementById('websiteDropdown');
                dropdown.innerHTML = this.availableWebsites.map(site => `
                    <div class="website-option" data-website="${site.id}">
                        <i class="fas fa-globe"></i>
                        <div class="website-info">
                            <div class="website-name">${site.name}</div>
                            <div class="website-type">${site.type}</div>
                        </div>
                        <div class="website-price">${site.price}</div>
                    </div>
                `).join('');

                // Add click listeners
                dropdown.querySelectorAll('.website-option').forEach(option => {
                    option.addEventListener('click', (e) => {
                        const websiteId = e.currentTarget.dataset.website;
                        this.loadWebsite(websiteId);
                        dropdown.classList.remove('active');
                    });
                });
            }

            setupToolSelection() {
                document.querySelectorAll('.tool-item').forEach(tool => {
                    tool.addEventListener('click', (e) => {
                        document.querySelectorAll('.tool-item').forEach(t => t.classList.remove('active'));
                        e.currentTarget.classList.add('active');
                        this.currentTool = e.currentTarget.dataset.tool;
                        this.switchPropertiesPanel(this.currentTool);
                        console.log(`🛠️ כלי נבחר: ${this.currentTool}`);
                    });
                });
            }

            setupKeyboardShortcuts() {
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey || e.metaKey) {
                        switch(e.key) {
                            case 's':
                                e.preventDefault();
                                this.saveWebsite();
                                break;
                            case 'z':
                                e.preventDefault();
                                this.undo();
                                break;
                            case 'y':
                                e.preventDefault();
                                this.redo();
                                break;
                        }
                    }
                    if (e.key === 'Delete' && this.selectedElement) {
                        this.deleteElement();
                    }
                    if (e.key === 'Escape') {
                        this.deselectElement();
                    }
                });
            }

            loadWebsite(websiteId) {
                this.showNotification('טוען אתר...', 'success');
                
                const website = this.availableWebsites.find(site => site.id === websiteId);
                if (!website) return;

                this.currentWebsite = websiteId;
                document.getElementById('currentSiteName').textContent = website.name;
                document.querySelector('#currentWebsite span').textContent = website.name;

                // Hide loader, show container
                document.getElementById('websiteLoader').style.display = 'none';
                document.getElementById('websiteContainer').style.display = 'block';

                // Load website content (this would normally fetch from server)
                this.loadWebsiteContent(websiteId);
                
                console.log(`🌐 נטען אתר: ${website.name}`);
            }

            loadWebsiteContent(websiteId) {
                // Demo content for each website
                const demoContent = {
                    'dr-michal-rosen': this.generateDoctorSite(),
                    'law-firm': this.generateLawFirmSite(),
                    'fitness-co': this.generateFitnessSite(),
                    'aesthetic-clinic': this.generateAestheticClinicSite()
                };

                const content = demoContent[websiteId] || this.generateDefaultSite(websiteId);
                document.getElementById('websiteContainer').innerHTML = content;
                
                // Setup editable elements
                this.setupEditableElements();
                this.showNotification('אתר נטען בהצלחה!', 'success');
            }

            generateAestheticClinicSite() {
                return `
                <div style="max-width: 1200px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; font-family: 'Assistant', sans-serif; direction: rtl;">
                    <!-- Header -->
                    <header style="background: linear-gradient(135deg, #8b5a8c, #d4af37); color: white; padding: 2rem; text-align: center;">
                        <h1 class="editable-element" data-type="text" data-element="main-title" style="font-size: 3rem; margin-bottom: 1rem; font-weight: 700;">
                            קליניקת יופי פרמיום
                            <div class="element-label">כותרת ראשית</div>
                        </h1>
                        <p class="editable-element" data-type="text" data-element="main-subtitle" style="font-size: 1.3rem; opacity: 0.9;">
                            ד"ר מירית כהן - מומחית אסתטיקה רפואית
                            <div class="element-label">כותרת משנה</div>
                        </p>
                    </header>

                    <!-- Hero Section -->
                    <section style="padding: 4rem 2rem; text-align: center; background: linear-gradient(135deg, #f5f7fa, #c3cfe2);">
                        <div class="editable-element" data-type="image" data-element="hero-image" style="width: 300px; height: 400px; background: linear-gradient(135deg, #8b5a8c, #d4af37); border-radius: 20px; margin: 0 auto 2rem; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                            תמונת ד"ר כהן
                            <div class="element-label">תמונה ראשית</div>
                        </div>
                        <h2 class="editable-element" data-type="text" data-element="hero-title" style="font-size: 2.5rem; color: #8b5a8c; margin-bottom: 1rem;">
                            יופי טבעי עם ניסיון של 15+ שנה
                            <div class="element-label">כותרת גיבור</div>
                        </h2>
                        <p class="editable-element" data-type="text" data-element="hero-text" style="font-size: 1.2rem; color: #666; margin-bottom: 2rem; max-width: 600px; margin-left: auto; margin-right: auto;">
                            טיפולי אסתטיקה רפואית מתקדמים עם הטכנולוגיות העדכניות ביותר לתוצאות מיטביות ובטוחות
                            <div class="element-label">טקסט גיבור</div>
                        </p>
                        <button class="editable-element" data-type="text" data-element="cta-button" style="background: linear-gradient(135deg, #8b5a8c, #d4af37); color: white; padding: 1rem 2rem; border: none; border-radius: 25px; font-size: 1.1rem; font-weight: 600; cursor: pointer;">
                            הזמני ייעוץ חינם
                            <div class="element-label">כפתור פעולה</div>
                        </button>
                    </section>

                    <!-- Services Section -->
                    <section style="padding: 4rem 2rem; background: white;">
                        <h2 class="editable-element" data-type="text" data-element="services-title" style="text-align: center; font-size: 2.5rem; color: #8b5a8c; margin-bottom: 3rem;">
                            השירותים שלנו
                            <div class="element-label">כותרת שירותים</div>
                        </h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; max-width: 1000px; margin: 0 auto;">
                            <div style="background: #f8f9fa; padding: 2rem; border-radius: 15px; text-align: center;">
                                <i class="fas fa-syringe" style="font-size: 3rem; color: #8b5a8c; margin-bottom: 1rem;"></i>
                                <h3 class="editable-element" data-type="text" data-element="service1-title" style="font-size: 1.5rem; color: #333; margin-bottom: 1rem;">
                                    בוטוקס רפואי
                                    <div class="element-label">כותרת שירות</div>
                                </h3>
                                <p class="editable-element" data-type="text" data-element="service1-text" style="color: #666; line-height: 1.6;">
                                    הזרקות בוטוקס מקצועיות להחלקת קמטים ומניעת הזדקנות עם תוצאות טבעיות
                                    <div class="element-label">תיאור שירות</div>
                                </p>
                                <div class="editable-element" data-type="text" data-element="service1-price" style="font-size: 1.8rem; font-weight: 700; color: #8b5a8c; margin-top: 1rem;">
                                    החל מ-₪1,200
                                    <div class="element-label">מחיר</div>
                                </div>
                            </div>
                            <div style="background: #f8f9fa; padding: 2rem; border-radius: 15px; text-align: center;">
                                <i class="fas fa-heart" style="font-size: 3rem; color: #8b5a8c; margin-bottom: 1rem;"></i>
                                <h3 class="editable-element" data-type="text" data-element="service2-title" style="font-size: 1.5rem; color: #333; margin-bottom: 1rem;">
                                    פילר היאלורונית
                                    <div class="element-label">כותרת שירות</div>
                                </h3>
                                <p class="editable-element" data-type="text" data-element="service2-text" style="color: #666; line-height: 1.6;">
                                    מילוי קמטים ועיצוב פנים עם חומצה היאלורונית איכותית לשיפור נפח השפתיים
                                    <div class="element-label">תיאור שירות</div>
                                </p>
                                <div class="editable-element" data-type="text" data-element="service2-price" style="font-size: 1.8rem; font-weight: 700; color: #8b5a8c; margin-top: 1rem;">
                                    החל מ-₪1,800
                                    <div class="element-label">מחיר</div>
                                </div>
                            </div>
                            <div style="background: #f8f9fa; padding: 2rem; border-radius: 15px; text-align: center;">
                                <i class="fas fa-bolt" style="font-size: 3rem; color: #8b5a8c; margin-bottom: 1rem;"></i>
                                <h3 class="editable-element" data-type="text" data-element="service3-title" style="font-size: 1.5rem; color: #333; margin-bottom: 1rem;">
                                    לייזר IPL
                                    <div class="element-label">כותרת שירות</div>
                                </h3>
                                <p class="editable-element" data-type="text" data-element="service3-text" style="color: #666; line-height: 1.6;">
                                    טיפול לייזר מתקדם להסרת שיער, טיפול בפיגמנטציה וחידוש העור בטכנולוגיה מתקדמת
                                    <div class="element-label">תיאור שירות</div>
                                </p>
                                <div class="editable-element" data-type="text" data-element="service3-price" style="font-size: 1.8rem; font-weight: 700; color: #8b5a8c; margin-top: 1rem;">
                                    החל מ-₪300
                                    <div class="element-label">מחיר</div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Contact Section -->
                    <section style="padding: 4rem 2rem; background: linear-gradient(135deg, #8b5a8c, #d4af37); color: white; text-align: center;">
                        <h2 class="editable-element" data-type="text" data-element="contact-title" style="font-size: 2.5rem; margin-bottom: 2rem;">
                            יצירת קשר
                            <div class="element-label">כותרת קשר</div>
                        </h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; max-width: 800px; margin: 0 auto;">
                            <div>
                                <i class="fas fa-phone" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                                <p class="editable-element" data-type="text" data-element="phone" style="font-size: 1.2rem;">
                                    050-123-4567
                                    <div class="element-label">טלפון</div>
                                </p>
                            </div>
                            <div>
                                <i class="fas fa-envelope" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                                <p class="editable-element" data-type="text" data-element="email" style="font-size: 1.2rem;">
                                    info@beauty-clinic.co.il
                                    <div class="element-label">אימייל</div>
                                </p>
                            </div>
                            <div>
                                <i class="fas fa-map-marker-alt" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                                <p class="editable-element" data-type="text" data-element="address" style="font-size: 1.2rem;">
                                    דיזנגוף 99, תל אביב
                                    <div class="element-label">כתובת</div>
                                </p>
                            </div>
                        </div>
                    </section>
                </div>
                `;
            }

            generateDoctorSite() {
                return `
                <div style="max-width: 1000px; margin: 0 auto; background: white; border-radius: 15px; overflow: hidden;">
                    <h1 class="editable-element" data-type="text" data-element="title">ד"ר מיכל רוזן - רפואה אסתטית</h1>
                    <p class="editable-element" data-type="text" data-element="subtitle">מומחית ברפואה אסתטית עם ניסיון של 10+ שנה</p>
                </div>
                `;
            }

            generateLawFirmSite() {
                return `<div style="max-width: 1000px; margin: 0 auto;"><h1 class="editable-element" data-type="text">משרד עורכי דין מובילים</h1></div>`;
            }

            generateFitnessSite() {
                return `<div style="max-width: 1000px; margin: 0 auto;"><h1 class="editable-element" data-type="text">מאמן כושר מקצועי</h1></div>`;
            }

            generateDefaultSite(websiteId) {
                const website = this.availableWebsites.find(site => site.id === websiteId);
                return `
                <div style="max-width: 1000px; margin: 0 auto; background: white; padding: 3rem; border-radius: 15px;">
                    <h1 class="editable-element" data-type="text" data-element="title">${website.name}</h1>
                    <p class="editable-element" data-type="text" data-element="subtitle">${website.type}</p>
                    <p class="editable-element" data-type="text" data-element="description">תיאור מקצועי של העסק יבוא כאן...</p>
                </div>
                `;
            }

            setupEditableElements() {
                const elements = document.querySelectorAll('.editable-element');
                
                elements.forEach(element => {
                    element.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.selectElement(element);
                    });

                    element.addEventListener('dblclick', (e) => {
                        e.stopPropagation();
                        this.quickEdit(element);
                    });
                });

                // Click outside to deselect
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.editable-element') && !e.target.closest('.right-toolbar')) {
                        this.deselectElement();
                    }
                });

                console.log(`✅ הוגדרו ${elements.length} אלמנטים לעריכה`);
            }

            selectElement(element) {
                // Remove previous selection
                document.querySelectorAll('.editable-element.selected').forEach(el => {
                    el.classList.remove('selected');
                });

                // Select new element
                element.classList.add('selected');
                this.selectedElement = element;

                // Switch to appropriate tool and panel
                const elementType = element.dataset.type || 'text';
                this.switchTool(elementType);
                this.populatePropertiesPanel(element);

                console.log(`🎯 נבחר אלמנט: ${element.dataset.element || 'ללא שם'}`);
            }

            deselectElement() {
                if (this.selectedElement) {
                    this.selectedElement.classList.remove('selected');
                    this.selectedElement = null;
                }
            }

            switchTool(toolType) {
                document.querySelectorAll('.tool-item').forEach(tool => {
                    tool.classList.remove('active');
                });
                
                const toolElement = document.querySelector(`[data-tool="${toolType}"]`);
                if (toolElement) {
                    toolElement.classList.add('active');
                    this.currentTool = toolType;
                    this.switchPropertiesPanel(toolType);
                }
            }

            switchPropertiesPanel(panelType) {
                document.querySelectorAll('.properties-panel').forEach(panel => {
                    panel.classList.remove('active');
                });
                
                const panelId = panelType === 'image' ? 'imagePanel' : 
                               panelType === 'color' ? 'colorPanel' : 'textPanel';
                
                const targetPanel = document.getElementById(panelId);
                if (targetPanel) {
                    targetPanel.classList.add('active');
                }
            }

            populatePropertiesPanel(element) {
                if (element.dataset.type === 'text' || !element.dataset.type) {
                    document.getElementById('textContent').value = element.textContent.trim();
                    
                    const computedStyle = window.getComputedStyle(element);
                    document.getElementById('fontSize').value = computedStyle.fontSize;
                    document.getElementById('fontWeight').value = computedStyle.fontWeight;
                    
                    // Convert RGB to HEX for color input
                    const rgbColor = computedStyle.color;
                    const hexColor = this.rgbToHex(rgbColor);
                    document.getElementById('textColor').value = hexColor;
                }
            }

            quickEdit(element) {
                if (element.dataset.type === 'text' || !element.dataset.type) {
                    const newText = prompt('הכנס טקסט חדש:', element.textContent.trim());
                    if (newText !== null && newText !== '') {
                        element.textContent = newText;
                        this.saveToHistory();
                        this.showNotification('טקסט עודכן בהצלחה!', 'success');
                    }
                }
            }

            switchDevice(device) {
                document.querySelectorAll('.device-option').forEach(option => {
                    option.classList.remove('active');
                });
                
                document.querySelector(`[data-device="${device}"]`).classList.add('active');
                
                const container = document.getElementById('websiteContainer');
                container.className = `website-container ${device}`;
                
                console.log(`📱 מכשיר הוחלף ל: ${device}`);
            }

            saveWebsite() {
                if (!this.currentWebsite) {
                    this.showNotification('אין אתר נבחר לשמירה', 'warning');
                    return;
                }

                const websiteData = {
                    id: this.currentWebsite,
                    content: document.getElementById('websiteContainer').innerHTML,
                    lastSaved: new Date().toISOString(),
                    elements: {}
                };

                // Collect element data
                document.querySelectorAll('.editable-element').forEach(element => {
                    const elementId = element.dataset.element || 'unnamed';
                    websiteData.elements[elementId] = {
                        content: element.textContent.trim(),
                        type: element.dataset.type || 'text',
                        styles: this.getElementStyles(element)
                    };
                });

                // Save to localStorage (in real app would save to server)
                localStorage.setItem(`website_${this.currentWebsite}`, JSON.stringify(websiteData));
                
                this.updateSaveStatus('נשמר ב-' + new Date().toLocaleTimeString('he-IL'));
                this.showNotification('האתר נשמר בהצלחה! 💾', 'success');
                
                console.log('💾 אתר נשמר:', websiteData);
            }

            autoSave() {
                if (this.currentWebsite && this.isEditing) {
                    const autoSaveData = {
                        id: this.currentWebsite,
                        content: document.getElementById('websiteContainer').innerHTML,
                        timestamp: new Date().toISOString()
                    };
                    
                    localStorage.setItem(`autosave_${this.currentWebsite}`, JSON.stringify(autoSaveData));
                    this.updateSaveStatus('נשמר אוטומטית ב-' + new Date().toLocaleTimeString('he-IL'));
                    console.log('🔄 שמירה אוטומטית');
                }
            }

            previewWebsite() {
                if (!this.currentWebsite) {
                    this.showNotification('אין אתר נבחר לתצוגה מקדימה', 'warning');
                    return;
                }

                const websiteContent = document.getElementById('websiteContainer').innerHTML;
                const previewHTML = `
                    <!DOCTYPE html>
                    <html lang="he" dir="rtl">
                    <head>
                        <meta charset="UTF-8">
                        <meta name="viewport" content="width=device-width, initial-scale=1.0">
                        <title>תצוגה מקדימה - ${this.currentWebsite}</title>
                        <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
                        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
                        <style>
                            body { 
                                font-family: 'Assistant', sans-serif; 
                                margin: 0; 
                                padding: 20px; 
                                direction: rtl; 
                                background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
                                min-height: 100vh;
                            }
                            .editable-element { outline: none !important; background: none !important; }
                            .element-label { display: none !important; }
                        </style>
                    </head>
                    <body>
                        ${websiteContent}
                    </body>
                    </html>
                `;

                const newWindow = window.open('', '_blank');
                newWindow.document.write(previewHTML);
                newWindow.document.close();
                
                this.showNotification('תצוגה מקדימה נפתחה בטאב חדש! 👁️', 'success');
                console.log('👁️ תצוגה מקדימה נפתחה');
            }

            exportWebsite() {
                if (!this.currentWebsite) {
                    this.showNotification('אין אתר נבחר לייצוא', 'warning');
                    return;
                }

                const websiteContent = document.getElementById('websiteContainer').innerHTML;
                const exportHTML = `<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${this.currentWebsite}</title>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { 
            font-family: 'Assistant', sans-serif; 
            margin: 0; 
            padding: 0; 
            direction: rtl; 
        }
        .editable-element { outline: none !important; background: none !important; }
        .element-label { display: none !important; }
    </style>
</head>
<body>
    ${websiteContent.replace(/class="editable-element[^"]*"/g, '').replace(/<div class="element-label">.*?<\/div>/g, '')}
</body>
</html>`;

                const blob = new Blob([exportHTML], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${this.currentWebsite}.html`;
                a.click();
                URL.revokeObjectURL(url);
                
                this.showNotification('האתר יוצא בהצלחה! 📁', 'success');
                console.log('📁 האתר יוצא');
            }

            saveToHistory() {
                const currentState = {
                    content: document.getElementById('websiteContainer').innerHTML,
                    timestamp: Date.now()
                };
                
                // Remove any future history if we're not at the end
                this.history = this.history.slice(0, this.historyIndex + 1);
                
                // Add new state
                this.history.push(currentState);
                this.historyIndex = this.history.length - 1;
                
                // Keep only last 50 states
                if (this.history.length > 50) {
                    this.history.shift();
                    this.historyIndex--;
                }
                
                this.isEditing = true;
            }

            undo() {
                if (this.historyIndex > 0) {
                    this.historyIndex--;
                    const previousState = this.history[this.historyIndex];
                    document.getElementById('websiteContainer').innerHTML = previousState.content;
                    this.setupEditableElements();
                    this.showNotification('פעולה בוטלה', 'success');
                    console.log('↶ Undo בוצע');
                }
            }

            redo() {
                if (this.historyIndex < this.history.length - 1) {
                    this.historyIndex++;
                    const nextState = this.history[this.historyIndex];
                    document.getElementById('websiteContainer').innerHTML = nextState.content;
                    this.setupEditableElements();
                    this.showNotification('פעולה חזרה', 'success');
                    console.log('↷ Redo בוצע');
                }
            }

            getElementStyles(element) {
                const computedStyle = window.getComputedStyle(element);
                return {
                    fontSize: computedStyle.fontSize,
                    fontWeight: computedStyle.fontWeight,
                    color: computedStyle.color,
                    backgroundColor: computedStyle.backgroundColor
                };
            }

            rgbToHex(rgb) {
                const rgbMatch = rgb.match(/\d+/g);
                if (rgbMatch) {
                    return `#${parseInt(rgbMatch[0]).toString(16).padStart(2, '0')}${parseInt(rgbMatch[1]).toString(16).padStart(2, '0')}${parseInt(rgbMatch[2]).toString(16).padStart(2, '0')}`;
                }
                return '#333333';
            }

            updateSaveStatus(status) {
                document.getElementById('saveStatus').textContent = status;
            }

            showNotification(message, type = 'success') {
                const notification = document.getElementById('notification');
                notification.className = `notification ${type}`;
                notification.querySelector('span').textContent = message;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
        }

        // Global functions for property panels
        window.applyTextProperties = function() {
            const editor = window.webMasterEditor;
            if (!editor.selectedElement) return;
            
            const textContent = document.getElementById('textContent').value;
            const fontSize = document.getElementById('fontSize').value;
            const fontWeight = document.getElementById('fontWeight').value;
            const textColor = document.getElementById('textColor').value;
            
            editor.selectedElement.textContent = textContent;
            editor.selectedElement.style.fontSize = fontSize;
            editor.selectedElement.style.fontWeight = fontWeight;
            editor.selectedElement.style.color = textColor;
            
            editor.saveToHistory();
            editor.showNotification('מאפיני טקסט עודכנו!', 'success');
        };

        window.applyImageProperties = function() {
            const editor = window.webMasterEditor;
            if (!editor.selectedElement) return;
            
            const imageUrl = document.getElementById('imageUrl').value;
            const imageAlt = document.getElementById('imageAlt').value;
            
            if (imageUrl) {
                if (editor.selectedElement.tagName === 'IMG') {
                    editor.selectedElement.src = imageUrl;
                    editor.selectedElement.alt = imageAlt;
                } else {
                    editor.selectedElement.style.backgroundImage = `url(${imageUrl})`;
                    editor.selectedElement.style.backgroundSize = 'cover';
                    editor.selectedElement.style.backgroundPosition = 'center';
                }
                
                editor.saveToHistory();
                editor.showNotification('תמונה עודכנה!', 'success');
            }
        };

        window.applyColorScheme = function() {
            const editor = window.webMasterEditor;
            const primaryColor = document.getElementById('primaryColor').value;
            const secondaryColor = document.getElementById('secondaryColor').value;
            const accentColor = document.getElementById('accentColor').value;
            
            // Apply colors to CSS variables if supported
            document.documentElement.style.setProperty('--primary-color', primaryColor);
            document.documentElement.style.setProperty('--secondary-color', secondaryColor);
            document.documentElement.style.setProperty('--accent-color', accentColor);
            
            editor.saveToHistory();
            editor.showNotification('ערכת צבעים הוחלה!', 'success');
        };

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            window.webMasterEditor = new WebMasterProEditor();
            console.log('🚀 WebMaster Pro Visual Editor Ultimate מוכן לשימוש!');
        });

        // Handle file uploads
        document.addEventListener('change', (e) => {
            if (e.target.id === 'imageFile' && e.target.files[0]) {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = (e) => {
                    document.getElementById('imageUrl').value = e.target.result;
                    window.webMasterEditor.showNotification('תמונה הועלתה בהצלחה!', 'success');
                };
                reader.readAsDataURL(file);
            }
        });

        // Prevent default drag behaviors
        document.addEventListener('dragover', (e) => e.preventDefault());
        document.addEventListener('drop', (e) => e.preventDefault());
    </script>
</body>
</html>
